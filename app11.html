<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maps App</title>

<!-- Bootstrap & Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<style>
body {
  font-family: "Poppins", system-ui, sans-serif;
  min-height: 100vh;
  color: #222;
  background: linear-gradient(135deg, #fffaf0, #f0f8ff);
  display: flex;
  flex-direction: column;
}
header {
  padding: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
header h1 {
  font-size: 1.1rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  color: #0d6efd;
}
.btn-back {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 0.9rem;
  background: linear-gradient(135deg, #0d6efd, #007bff);
  color: white;
  border: none;
  border-radius: 50px;
  padding: 8px 16px;
  text-decoration: none;
  box-shadow: 0 2px 6px rgba(13,110,253,0.3);
  transition: all 0.3s ease;
}
.btn-back:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(13,110,253,0.4);
  color: white;
}
main {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
}
#searchBar {
  width: 100%;
  max-width: 500px;
  margin-bottom: 15px;
}
.map-container {
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(8px);
  border-radius: 20px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.08);
  width: 100%;
  max-width: 500px;
  height: 450px;
  overflow: hidden;
  position: relative;
  padding: 10px;
}
#map { width: 100%; height: 100%; border-radius: 20px; }
footer {
  text-align: center;
  padding: 10px;
  font-size: 0.85rem;
  color: #6c757d;
}
</style>
</head>
<body>

<header>
  <h1><i class="bi bi-map-fill"></i> Maps</h1>
  <a href="index.html" class="btn-back"><i class="bi bi-arrow-left"></i> Home</a>
</header>

<main>
  <input type="text" id="searchBar" class="form-control" placeholder="Search location...">
  <div class="map-container">
    <div id="map"></div>
  </div>
</main>

<footer>© 2025 — Maps App</footer>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
// Initialize map
const map = L.map('map').setView([20,0], 2);

// Tile layers
const street = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap contributors'
}).addTo(map);

const satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
  attribution: 'Tiles &copy; Esri &mdash; Source: Esri, Maxar, Earthstar Geographics'
});

const terrain = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
  attribution: 'Map data: © OpenTopoMap contributors'
});

// Layer control
L.control.layers({
  "Street": street,
  "Satellite": satellite,
  "Terrain": terrain
}).addTo(map);

// Locate user
if(navigator.geolocation){
  navigator.geolocation.getCurrentPosition(position=>{
    const lat = position.coords.latitude;
    const lng = position.coords.longitude;
    map.setView([lat,lng], 13);
    L.marker([lat,lng]).addTo(map).bindPopup("You are here").openPopup();
  });
}

// Add marker on click
map.on('click', e=>{
  const {lat,lng} = e.latlng;
  L.marker([lat,lng]).addTo(map)
    .bindPopup(`Lat: ${lat.toFixed(4)}, Lng: ${lng.toFixed(4)}`)
    .openPopup();
});

// Search functionality using Nominatim API with flyTo
const searchBar = document.getElementById('searchBar');
searchBar.addEventListener('keypress', async (e)=>{
  if(e.key==='Enter'){
    const query = searchBar.value.trim();
    if(!query) return;
    const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}`;
    const response = await fetch(url);
    const results = await response.json();
    if(results && results.length>0){
      const place = results[0];
      const lat = parseFloat(place.lat);
      const lon = parseFloat(place.lon);
      map.flyTo([lat,lon], 13, {duration: 2});
      L.marker([lat,lon]).addTo(map).bindPopup(place.display_name).openPopup();
    } else {
      alert('Location not found');
    }
  }
});
</script>

</body>
</html>
